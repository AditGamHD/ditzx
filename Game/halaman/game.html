<div class="game-container">
    <div class="game-header">
        <h2><i class="fas fa-gamepad"></i> Jelajahi Game</h2>
        <div class="search-bar">
            <input type="text" id="gameSearch" placeholder="Cari game...">
            <button id="searchBtn"><i class="fas fa-search"></i></button>
        </div>
    </div>

    <div class="filter-section">
        <div class="filter-tags">
            <button class="filter-btn active">Semua</button>
            <button class="filter-btn">Populer</button>
            <button class="filter-btn">Baru</button>
            <button class="filter-btn">Rekomendasi</button>
            <button class="filter-btn">Multiplayer</button>
            <button class="filter-btn">Single Player</button>
        </div>
        
        <div class="sort-select">
            <select id="sortBy">
                <option value="popular">Paling Populer</option>
                <option value="newest">Terbaru</option>
                <option value="rating">Rating Tertinggi</option>
                <option value="players">Pemain Terbanyak</option>
            </select>
        </div>
    </div>

    <div class="games-list" id="gamesList">
        <!-- Game list will be loaded here -->
        <div class="game-item skeleton">
            <div class="skeleton-image"></div>
            <div class="skeleton-content">
                <div class="skeleton-text"></div>
                <div class="skeleton-text short"></div>
                <div class="skeleton-text very-short"></div>
            </div>
        </div>
        <!-- Repeat for more skeletons -->
    </div>

    <div class="pagination">
        <button class="page-btn" id="prevPage"><i class="fas fa-chevron-left"></i></button>
        <span class="page-info">Halaman <span id="currentPage">1</span></span>
        <button class="page-btn" id="nextPage"><i class="fas fa-chevron-right"></i></button>
    </div>
</div>

<style>
    .game-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .game-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
        gap: 20px;
    }

    .game-header h2 {
        font-size: 2em;
        color: #fff;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .search-bar {
        display: flex;
        background: rgba(255,255,255,0.05);
        border-radius: 10px;
        overflow: hidden;
        border: 1px solid rgba(255,255,255,0.1);
        width: 100%;
        max-width: 400px;
    }

    .search-bar input {
        flex: 1;
        padding: 12px 15px;
        background: transparent;
        border: none;
        color: white;
        font-size: 16px;
    }

    .search-bar input::placeholder {
        color: #8a8da0;
    }

    .search-bar button {
        background: #00adb5;
        border: none;
        color: white;
        padding: 0 20px;
        cursor: pointer;
        transition: background 0.3s;
    }

    .search-bar button:hover {
        background: #0097a7;
    }

    .filter-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
        gap: 20px;
    }

    .filter-tags {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .filter-btn {
        padding: 8px 16px;
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.1);
        color: #8a8da0;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 14px;
    }

    .filter-btn:hover {
        background: rgba(0,173,181,0.2);
        color: #00adb5;
    }

    .filter-btn.active {
        background: #00adb5;
        color: white;
        border-color: #00adb5;
    }

    .sort-select select {
        padding: 8px 16px;
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.1);
        color: white;
        border-radius: 8px;
        cursor: pointer;
        min-width: 200px;
    }

    .sort-select select option {
        background: #1a1a2e;
    }

    .games-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .game-item {
        display: flex;
        background: rgba(255,255,255,0.05);
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid rgba(255,255,255,0.1);
        transition: all 0.3s;
    }

    .game-item:hover {
        transform: translateY(-3px);
        border-color: #00adb5;
        box-shadow: 0 5px 15px rgba(0,173,181,0.2);
    }

    .game-item img {
        width: 120px;
        height: 120px;
        object-fit: cover;
    }

    .game-info {
        flex: 1;
        padding: 15px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .game-info h4 {
        font-size: 1.2em;
        color: #fff;
        margin-bottom: 5px;
    }

    .game-info p {
        color: #8a8da0;
        font-size: 0.9em;
        margin-bottom: 10px;
        flex: 1;
    }

    .game-stats {
        display: flex;
        gap: 15px;
    }

    .game-stats span {
        display: flex;
        align-items: center;
        gap: 5px;
        color: #8a8da0;
        font-size: 0.9em;
    }

    .game-stats i {
        color: #00adb5;
    }

    .game-item .play-btn {
        margin: 15px;
        align-self: center;
        padding: 10px 20px;
        background: #00adb5;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s;
    }

    .game-item .play-btn:hover {
        background: #0097a7;
    }

    .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        margin-top: 40px;
    }

    .page-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.1);
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
    }

    .page-btn:hover:not(:disabled) {
        background: #00adb5;
    }

    .page-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .page-info {
        color: #8a8da0;
        font-size: 1em;
    }

    /* Skeleton loading */
    .game-item.skeleton {
        border: none;
        background: transparent;
    }

    .skeleton-content {
        flex: 1;
        padding: 15px;
    }

    .skeleton-text {
        height: 20px;
        background: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
        margin-bottom: 10px;
        border-radius: 4px;
    }

    .skeleton-text.short {
        width: 70%;
    }

    .skeleton-text.very-short {
        width: 50%;
    }

    @media (max-width: 768px) {
        .game-header {
            flex-direction: column;
            align-items: stretch;
        }
        
        .search-bar {
            max-width: 100%;
        }
        
        .filter-section {
            flex-direction: column;
            align-items: stretch;
        }
        
        .sort-select select {
            width: 100%;
        }
        
        .game-item {
            flex-direction: column;
        }
        
        .game-item img {
            width: 100%;
            height: 180px;
        }
        
        .game-item .play-btn {
            margin: 15px;
            width: calc(100% - 30px);
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        let currentPage = 1;
        const gamesPerPage = 10;
        let allGames = [];
        
        // Initialize game list
        loadGameList();
        
        // Search functionality
        document.getElementById('searchBtn').addEventListener('click', searchGames);
        document.getElementById('gameSearch').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchGames();
        });
        
        // Filter buttons
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                filterGames(this.textContent);
            });
        });
        
        // Sort functionality
        document.getElementById('sortBy').addEventListener('change', sortGames);
        
        // Pagination
        document.getElementById('prevPage').addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                updateGameDisplay();
            }
        });
        
        document.getElementById('nextPage').addEventListener('click', () => {
            if (currentPage * gamesPerPage < allGames.length) {
                currentPage++;
                updateGameDisplay();
            }
        });
        
        function loadGameList() {
            const database = firebase.database();
            database.ref('games').once('value').then((snapshot) => {
                if (snapshot.exists()) {
                    allGames = Object.entries(snapshot.val()).map(([id, game]) => ({
                        id,
                        ...game
                    }));
                    updateGameDisplay();
                }
            });
        }
        
        function updateGameDisplay() {
            const startIndex = (currentPage - 1) * gamesPerPage;
            const endIndex = startIndex + gamesPerPage;
            const gamesToShow = allGames.slice(startIndex, endIndex);
            
            const gamesList = document.getElementById('gamesList');
            if (gamesToShow.length > 0) {
                gamesList.innerHTML = gamesToShow.map(game => `
                    <div class="game-item">
                        <img src="${game.thumbnail || 'https://via.placeholder.com/120x120'}" alt="${game.title}">
                        <div class="game-info">
                            <h4>${game.title}</h4>
                            <p>${game.description || 'Game seru yang bisa kamu mainkan!'}</p>
                            <div class="game-stats">
                                <span><i class="fas fa-users"></i> ${game.players || 0} pemain</span>
                                <span><i class="fas fa-star"></i> ${game.rating || 'N/A'}</span>
                                <span><i class="fas fa-calendar"></i> ${new Date(game.createdAt || Date.now()).toLocaleDateString()}</span>
                            </div>
                        </div>
                        <button class="play-btn" data-game="${game.id}">
                            <i class="fas fa-play"></i> Mainkan
                        </button>
                    </div>
                `).join('');
            } else {
                gamesList.innerHTML = '<div style="text-align: center; padding: 40px; color: #8a8da0;">Belum ada game tersedia</div>';
            }
            
            // Update pagination info
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('prevPage').disabled = currentPage === 1;
            document.getElementById('nextPage').disabled = endIndex >= allGames.length;
            
            // Add click event to play buttons
            document.querySelectorAll('.play-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const gameId = this.dataset.game;
                    showToast(`Memulai game: ${allGames.find(g => g.id === gameId)?.title || gameId}`);
                    // Implement game launch logic
                });
            });
        }
        
        function searchGames() {
            const searchTerm = document.getElementById('gameSearch').value.toLowerCase();
            if (searchTerm) {
                const filtered = allGames.filter(game => 
                    game.title.toLowerCase().includes(searchTerm) ||
                    (game.description && game.description.toLowerCase().includes(searchTerm))
                );
                allGames = filtered;
                currentPage = 1;
                updateGameDisplay();
            }
        }
        
        function filterGames(filter) {
            // Implement filter logic based on filter type
            // For now, just reload all games
            loadGameList();
        }
        
        function sortGames() {
            const sortBy = document.getElementById('sortBy').value;
            
            switch(sortBy) {
                case 'popular':
                    allGames.sort((a, b) => (b.players || 0) - (a.players || 0));
                    break;
                case 'newest':
                    allGames.sort((a, b) => (b.createdAt || 0) - (a.createdAt || 0));
                    break;
                case 'rating':
                    allGames.sort((a, b) => (b.rating || 0) - (a.rating || 0));
                    break;
                case 'players':
                    allGames.sort((a, b) => (b.players || 0) - (a.players || 0));
                    break;
            }
            
            currentPage = 1;
            updateGameDisplay();
        }
    });
</script>
